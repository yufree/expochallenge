<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width">
<meta property="og:title" content="A Multi-page HTML Document" />




<meta name="author" content="Miao Yu and Lauren Petrick" />

<meta name="date" content="2021-04-14" />

<meta name="description" content="A Multi-page HTML Document">

<script id="pandoc-meta" type="application/json">
{"newpage_html_class":"page-break-after","date":"2021-04-14","output":{"pagedown::html_paged":{"self_contained":null,"toc":"true"}},"author":"Miao Yu and Lauren Petrick","title":"A Multi-page HTML Document"}
</script>

<title>A Multi-page HTML Document</title>


<script src="script_files/header-attrs-2.7/header-attrs.js"></script>
<link href="script_files/paged-0.13/css/default-fonts.css" rel="stylesheet" />
<link href="script_files/paged-0.13/css/default-page.css" rel="stylesheet" />
<link href="script_files/paged-0.13/css/default.css" rel="stylesheet" />
<script src="script_files/paged-0.13/js/config.js"></script>
<script src="script_files/paged-0.13/js/paged.js"></script>
<script src="script_files/paged-0.13/js/hooks.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



</head>

<body>

<div class="running-h1-title"></div>

<div class="running-h2-title"></div>



<div class="front-page">
<div id="header" class="title-page">
<h1 class="title">A Multi-page HTML Document</h1>
<h2 class="author">Miao Yu and Lauren Petrick</h2>
<h2 class="date">2021-04-14</h2>
</div>
</div>

<div class="front-matter-container">
<div id="TOC" class="level1 toc front-matter">
<ul>
<li><a href="#import-the-data-and-transfer-data-format"><span class="toc-section-number">1</span> Import the data and transfer data format</a></li>
<li><a href="#gatekeeper-discovery"><span class="toc-section-number">2</span> Gatekeeper Discovery</a></li>
<li><a href="#gatekeeper-association-with-asthma"><span class="toc-section-number">3</span> Gatekeeper association with asthma</a></li>
<li><a href="#gene"><span class="toc-section-number">4</span> Gene</a></li>
<li><a href="#gatekeeper-discovery-1"><span class="toc-section-number">5</span> Gatekeeper Discovery</a></li>
</ul>
</div>
</div>

<div class="main">
<div id="import-the-data-and-transfer-data-format" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Import the data and transfer data format</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/exposome.RData&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/metabol_serum.Rdata&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Biobase)</span></code></pre></div>
<pre><code>## Loading required package: BiocGenerics</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## 
## Attaching package: &#39;BiocGenerics&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:parallel&#39;:
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
##     clusterExport, clusterMap, parApply, parCapply, parLapply,
##     parLapplyLB, parRapply, parSapply, parSapplyLB</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     IQR, mad, sd, var, xtabs</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     anyDuplicated, append, as.data.frame, basename, cbind, colnames,
##     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,
##     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,
##     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
##     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,
##     union, unique, unsplit, which.max, which.min</code></pre>
<pre><code>## Welcome to Bioconductor
## 
##     Vignettes contain introductory material; view with
##     &#39;browseVignettes()&#39;. To cite Bioconductor, see
##     &#39;citation(&quot;Biobase&quot;)&#39;, and for packages &#39;citation(&quot;pkgname&quot;)&#39;.</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pds <span class="ot">&lt;-</span> <span class="fu">pData</span>(metabol_serum)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fds <span class="ot">&lt;-</span> <span class="fu">fData</span>(metabol_serum)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>eds <span class="ot">&lt;-</span> <span class="fu">exprs</span>(metabol_serum)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>exposome <span class="ot">&lt;-</span> exposome[<span class="fu">match</span>(pds<span class="sc">$</span>ID,exposome<span class="sc">$</span>ID),]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># only use numeric vairable</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>row <span class="ot">&lt;-</span> <span class="fu">sapply</span>(exposome, is.numeric)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>exp <span class="ot">&lt;-</span> <span class="fu">t</span>(exposome[,row])</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>phenotype <span class="ot">&lt;-</span> phenotype[<span class="fu">match</span>(pds<span class="sc">$</span>ID,phenotype<span class="sc">$</span>ID),]</span></code></pre></div>
</div>
<div id="gatekeeper-discovery" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Gatekeeper Discovery</h1>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github(&#39;yufree/enet&#39;)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(enet)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggnetwork)</span></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check correlation among exposure</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>enet <span class="ot">&lt;-</span> <span class="fu">geteenet</span>(exp[<span class="sc">-</span><span class="dv">1</span>,])</span></code></pre></div>
<pre><code>## 169 exposures could be used for network analysis</code></pre>
<pre><code>## 15 exposures correlation network clusters found</code></pre>
<pre><code>## 91 out of 169 exposures have no correlation with other exposures</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check correlation among metabolites</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mnets <span class="ot">&lt;-</span> <span class="fu">getmmnet</span>(eds)</span></code></pre></div>
<pre><code>## 11 metabolites correlation network clusters found</code></pre>
<pre><code>## 152 out of 177 metabolites have no correlation with other metabolites</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_data_frame</span>(mnets<span class="sc">$</span>net,<span class="at">directed =</span> F)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">V</span>(net)<span class="sc">$</span>membership <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">components</span>(net)<span class="sc">$</span>membership</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ggnetwork</span>(net)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>pm1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(n, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edges</span>(<span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>,<span class="at">size=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_nodes</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">as.factor</span>(membership))) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span>F,<span class="at">size=</span>F) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Serum Metabolites network&#39;</span>) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_blank</span>()<span class="sc">+</span><span class="fu">ggsave</span>(<span class="st">&#39;mnec.png&#39;</span>)</span></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check correlation between metabolites and exposures</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="fu">getemnet</span>(<span class="fu">exp</span>(eds),exp[<span class="sc">-</span><span class="dv">1</span>,])</span></code></pre></div>
<pre><code>## 9 metabolites correlation network clusters found</code></pre>
<pre><code>## 155 out of 177 metabolites have no correlation with other metabolites</code></pre>
<pre><code>## 169 exposures could be used for network analysis</code></pre>
<pre><code>## 15 exposures correlation network clusters found</code></pre>
<pre><code>## 91 out of 169 exposures have no correlation with other exposures</code></pre>
<pre><code>## 170 peaks with multiple exposures associated</code></pre>
<pre><code>## 1 peaks with 83 exposures associated</code></pre>
<pre><code>## 4 peaks with 79 exposures associated</code></pre>
<pre><code>## 4 peaks with 35 exposures associated</code></pre>
<pre><code>## 2 peaks with 45 exposures associated</code></pre>
<pre><code>## 3 peaks with 52 exposures associated</code></pre>
<pre><code>## 6 peaks with 50 exposures associated</code></pre>
<pre><code>## 3 peaks with 103 exposures associated</code></pre>
<pre><code>## 1 peaks with 14 exposures associated</code></pre>
<pre><code>## 4 peaks with 53 exposures associated</code></pre>
<pre><code>## 1 peaks with 76 exposures associated</code></pre>
<pre><code>## 3 peaks with 70 exposures associated</code></pre>
<pre><code>## 3 peaks with 66 exposures associated</code></pre>
<pre><code>## 2 peaks with 2 exposures associated</code></pre>
<pre><code>## 2 peaks with 49 exposures associated</code></pre>
<pre><code>## 2 peaks with 26 exposures associated</code></pre>
<pre><code>## 7 peaks with 1 exposures associated</code></pre>
<pre><code>## 2 peaks with 88 exposures associated</code></pre>
<pre><code>## 6 peaks with 40 exposures associated</code></pre>
<pre><code>## 3 peaks with 23 exposures associated</code></pre>
<pre><code>## 2 peaks with 24 exposures associated</code></pre>
<pre><code>## 5 peaks with 12 exposures associated</code></pre>
<pre><code>## 2 peaks with 31 exposures associated</code></pre>
<pre><code>## 2 peaks with 90 exposures associated</code></pre>
<pre><code>## 2 peaks with 63 exposures associated</code></pre>
<pre><code>## 2 peaks with 34 exposures associated</code></pre>
<pre><code>## 1 peaks with 21 exposures associated</code></pre>
<pre><code>## 2 peaks with 11 exposures associated</code></pre>
<pre><code>## 2 peaks with 20 exposures associated</code></pre>
<pre><code>## 4 peaks with 68 exposures associated</code></pre>
<pre><code>## 2 peaks with 67 exposures associated</code></pre>
<pre><code>## 1 peaks with 120 exposures associated</code></pre>
<pre><code>## 4 peaks with 39 exposures associated</code></pre>
<pre><code>## 1 peaks with 6 exposures associated</code></pre>
<pre><code>## 3 peaks with 58 exposures associated</code></pre>
<pre><code>## 3 peaks with 54 exposures associated</code></pre>
<pre><code>## 1 peaks with 32 exposures associated</code></pre>
<pre><code>## 3 peaks with 48 exposures associated</code></pre>
<pre><code>## 3 peaks with 85 exposures associated</code></pre>
<pre><code>## 2 peaks with 30 exposures associated</code></pre>
<pre><code>## 1 peaks with 77 exposures associated</code></pre>
<pre><code>## 2 peaks with 64 exposures associated</code></pre>
<pre><code>## 1 peaks with 81 exposures associated</code></pre>
<pre><code>## 3 peaks with 3 exposures associated</code></pre>
<pre><code>## 1 peaks with 100 exposures associated</code></pre>
<pre><code>## 2 peaks with 57 exposures associated</code></pre>
<pre><code>## 1 peaks with 80 exposures associated</code></pre>
<pre><code>## 4 peaks with 73 exposures associated</code></pre>
<pre><code>## 2 peaks with 15 exposures associated</code></pre>
<pre><code>## 2 peaks with 82 exposures associated</code></pre>
<pre><code>## 3 peaks with 59 exposures associated</code></pre>
<pre><code>## 1 peaks with 41 exposures associated</code></pre>
<pre><code>## 4 peaks with 91 exposures associated</code></pre>
<pre><code>## 2 peaks with 44 exposures associated</code></pre>
<pre><code>## 2 peaks with 124 exposures associated</code></pre>
<pre><code>## 1 peaks with 126 exposures associated</code></pre>
<pre><code>## 1 peaks with 112 exposures associated</code></pre>
<pre><code>## 2 peaks with 109 exposures associated</code></pre>
<pre><code>## 1 peaks with 125 exposures associated</code></pre>
<pre><code>## 1 peaks with 96 exposures associated</code></pre>
<pre><code>## 2 peaks with 9 exposures associated</code></pre>
<pre><code>## 1 peaks with 121 exposures associated</code></pre>
<pre><code>## 2 peaks with 102 exposures associated</code></pre>
<pre><code>## 2 peaks with 56 exposures associated</code></pre>
<pre><code>## 1 peaks with 46 exposures associated</code></pre>
<pre><code>## 1 peaks with 25 exposures associated</code></pre>
<pre><code>## 1 peaks with 84 exposures associated</code></pre>
<pre><code>## 1 peaks with 97 exposures associated</code></pre>
<pre><code>## 1 peaks with 65 exposures associated</code></pre>
<pre><code>## 2 peaks with 51 exposures associated</code></pre>
<pre><code>## 1 peaks with 127 exposures associated</code></pre>
<pre><code>## 1 peaks with 60 exposures associated</code></pre>
<pre><code>## 1 peaks with 16 exposures associated</code></pre>
<pre><code>## 2 peaks with 36 exposures associated</code></pre>
<pre><code>## 3 peaks with 33 exposures associated</code></pre>
<pre><code>## 1 peaks with 110 exposures associated</code></pre>
<pre><code>## 1 peaks with 98 exposures associated</code></pre>
<pre><code>## 1 peaks with 19 exposures associated</code></pre>
<pre><code>## 1 peaks with 7 exposures associated</code></pre>
<pre><code>## 1 peaks with 29 exposures associated</code></pre>
<pre><code>## 1 peaks with 106 exposures associated</code></pre>
<pre><code>## 1 peaks with 22 exposures associated</code></pre>
<pre><code>## 1 peaks with 8 exposures associated</code></pre>
<pre><code>## 1 peaks with 17 exposures associated</code></pre>
<pre><code>## 1 peaks with 55 exposures associated</code></pre>
<pre><code>## 1 peaks with 72 exposures associated</code></pre>
<pre><code>## 1 peaks with 61 exposures associated</code></pre>
<pre><code>## 22 peaks connected with other peaks and exposures</code></pre>
<pre><code>## 155 peaks connected with exposures only</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># screen gatekeeper</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>gkidx <span class="ot">&lt;-</span> <span class="fu">sapply</span>(re<span class="sc">$</span>data, <span class="cf">function</span>(x) <span class="fu">dim</span>(x)[<span class="dv">2</span>]<span class="sc">==</span><span class="dv">4</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>edsgk <span class="ot">&lt;-</span> eds[gkidx,]</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(re<span class="sc">$</span>me) </span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>na <span class="ot">&lt;-</span> <span class="fu">rownames</span>(tb)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(network)</span></code></pre></div>
<pre><code>## network: Classes for Relational Data
## Version 1.16.1 created on 2020-10-06.
## copyright (c) 2005, Carter T. Butts, University of California-Irvine
##                     Mark S. Handcock, University of California -- Los Angeles
##                     David R. Hunter, Penn State University
##                     Martina Morris, University of Washington
##                     Skye Bender-deMoll, University of Washington
##  For citation information, type citation(&quot;network&quot;).
##  Type help(&quot;network-package&quot;) to get started.</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggnetwork)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:network&#39;:
## 
##     %c%, %s%, add.edges, add.vertices, delete.edges, delete.vertices,
##     get.edge.attribute, get.edges, get.vertex.attribute, is.bipartite,
##     is.directed, list.edge.attributes, list.vertex.attributes,
##     set.edge.attribute, set.vertex.attribute</code></pre>
<pre><code>## The following objects are masked from &#39;package:BiocGenerics&#39;:
## 
##     normalize, path, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     union</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>allme <span class="ot">&lt;-</span> re<span class="sc">$</span>data[<span class="fu">sapply</span>(re<span class="sc">$</span>data, dim)[<span class="dv">2</span>,]<span class="sc">==</span><span class="dv">4</span>]</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>allmedf <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,allme)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>allmedfm <span class="ot">&lt;-</span> allmedf[allmedf<span class="sc">$</span>to<span class="sc">%in%</span>na,]</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">apply</span>(<span class="fu">table</span>(allmedfm<span class="sc">$</span>from,allmedfm<span class="sc">$</span>to),<span class="dv">1</span>,sum)<span class="sc">&gt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 12</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 12</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>mname <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">apply</span>(<span class="fu">table</span>(allmedfm<span class="sc">$</span>from,allmedfm<span class="sc">$</span>to),<span class="dv">1</span>,sum)[<span class="fu">apply</span>(<span class="fu">table</span>(allmedfm<span class="sc">$</span>from,allmedfm<span class="sc">$</span>to),<span class="dv">1</span>,sum)<span class="sc">&gt;</span><span class="dv">1</span>])</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>allmedf2 <span class="ot">&lt;-</span> allmedf[allmedf<span class="sc">$</span>from <span class="sc">%in%</span> mname<span class="sc">|</span>allmedf<span class="sc">$</span>to <span class="sc">%in%</span> mname,]</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>idxx <span class="ot">&lt;-</span> <span class="fu">paste</span>(allmedf<span class="sc">$</span>from,allmedf<span class="sc">$</span>to,allmedf<span class="sc">$</span>direction)</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> allmedf[<span class="sc">!</span><span class="fu">duplicated</span>(idxx),]</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df[<span class="sc">!</span>df<span class="sc">$</span>from<span class="sc">%in%</span>df<span class="sc">$</span>from[df<span class="sc">$</span>from<span class="sc">==</span>df<span class="sc">$</span>to],]</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> df2[df2<span class="sc">$</span>to<span class="sc">%in%</span>na,]</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> df2[<span class="sc">!</span>df2<span class="sc">$</span>to<span class="sc">%in%</span>na,]</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>df5 <span class="ot">&lt;-</span> df4[df4<span class="sc">$</span>to <span class="sc">%in%</span> <span class="fu">unique</span>(df3<span class="sc">$</span>from)<span class="sc">|</span>df4<span class="sc">$</span>from <span class="sc">%in%</span> <span class="fu">unique</span>(df3<span class="sc">$</span>from),]</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>df6 <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(df3,df5)</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>gknamez <span class="ot">&lt;-</span> df3<span class="sc">$</span>from</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">as.network</span>(df6,<span class="at">loops =</span> F,<span class="at">directed =</span> F,<span class="at">matrix.type =</span> <span class="st">&#39;edgelist&#39;</span>)</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>net <span class="sc">%e%</span> <span class="st">&#39;direction&#39;</span> <span class="ot">&lt;-</span> df6<span class="sc">$</span>direction</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ggnetwork</span>(net)</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>n<span class="sc">$</span>direction <span class="ot">&lt;-</span> <span class="fu">factor</span>(n<span class="sc">$</span>direction,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;positive&#39;</span>,<span class="st">&#39;negative&#39;</span>))</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggnetwork)</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(n, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edges</span>(<span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>,<span class="at">size=</span><span class="dv">1</span>,<span class="fu">aes</span>(<span class="at">linetype =</span> direction)) <span class="sc">+</span></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_nodes</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="dv">2</span>,<span class="at">shape=</span><span class="fu">ifelse</span>(vertex.names <span class="sc">%in%</span> gknamez,<span class="st">&#39;square&#39;</span>,<span class="st">&#39;circle&#39;</span>),<span class="at">color=</span> <span class="fu">ifelse</span>(vertex.names <span class="sc">%in%</span> na,<span class="st">&#39;black&#39;</span>,<span class="st">&#39;blue&#39;</span>))) <span class="sc">+</span></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_nodelabel_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(vertex.names <span class="sc">%in%</span> gknamez,vertex.names,<span class="cn">NA</span>)),</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">box.padding =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;lines&quot;</span>))<span class="sc">+</span></span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">size =</span> <span class="cn">FALSE</span>,<span class="at">shape=</span>F,<span class="at">color=</span>F) <span class="sc">+</span></span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_blank</span>() <span class="sc">+</span><span class="fu">ggsave</span>(<span class="st">&#39;menec.png&#39;</span>)</span></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<pre><code>## Warning: Removed 156 rows containing missing values (geom_label_repel).</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&#39;upset.png&#39;</span>,<span class="at">width =</span> <span class="dv">2000</span>,<span class="at">height =</span> <span class="dv">1200</span>,<span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(re<span class="sc">$</span>me) </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>na <span class="ot">&lt;-</span> <span class="fu">rownames</span>(tb)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> tb[na<span class="sc">%in%</span>gknamez,]</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(tb))</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>na <span class="ot">&lt;-</span> <span class="fu">rownames</span>(tb)</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(UpSetR)</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>listinput <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">`</span><span class="at">C16.1</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.C16<span class="fl">.1</span><span class="sc">==</span><span class="dv">1</span>],<span class="st">`</span><span class="at">C8</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.C8<span class="sc">==</span><span class="dv">1</span>],<span class="st">`</span><span class="at">leu</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.Leu<span class="sc">==</span><span class="dv">1</span>],<span class="st">`</span><span class="at">lysoPC.a.C26.1</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.lysoPC.a.C26<span class="fl">.1</span><span class="sc">==</span><span class="dv">1</span>],<span class="st">`</span><span class="at">lysoPC.a.C28.0</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.lysoPC.a.C28<span class="fl">.0</span><span class="sc">==</span><span class="dv">1</span>],<span class="st">`</span><span class="at">lysoPC.a.C28.1</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.lysoPC.a.C28<span class="fl">.1</span><span class="sc">==</span><span class="dv">1</span>],<span class="st">`</span><span class="at">PC.aa.C40.6</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.PC.aa.C40<span class="fl">.6</span><span class="sc">==</span><span class="dv">1</span>],<span class="st">`</span><span class="at">PC.ae.C36.3</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.PC.ae.C36<span class="fl">.3</span><span class="sc">==</span><span class="dv">1</span>],<span class="st">`</span><span class="at">PC.ae.C38.5</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.PC.ae.C38<span class="fl">.5</span><span class="sc">==</span><span class="dv">1</span>],<span class="st">`</span><span class="at">SM.C18.1</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.SM.C18<span class="fl">.1</span>], <span class="st">`</span><span class="at">Spermine</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.Spermine],<span class="st">`</span><span class="at">Val</span><span class="st">`</span><span class="ot">=</span>na[tb<span class="sc">$</span>log.Val])</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(<span class="fu">fromList</span>(listinput), <span class="at">order.by =</span> <span class="st">&quot;freq&quot;</span>, <span class="at">nsets=</span><span class="dv">10</span>,<span class="at">mainbar.y.label =</span> <span class="st">&quot;Associated exposures(s)&quot;</span>)</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
</div>
<div id="gatekeeper-association-with-asthma" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Gatekeeper association with asthma</h1>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> genefilter<span class="sc">::</span><span class="fu">rowttests</span>(edsgk,<span class="fu">factor</span>(phenotype<span class="sc">$</span>hs_asthma))</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> genefilter<span class="sc">::</span><span class="fu">rowttests</span>(eds,<span class="fu">factor</span>(phenotype<span class="sc">$</span>hs_asthma))</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>xxx <span class="ot">&lt;-</span> genefilter<span class="sc">::</span><span class="fu">rowttests</span>(exp[<span class="sc">-</span><span class="dv">1</span>,],<span class="fu">factor</span>(phenotype<span class="sc">$</span>hs_asthma))</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x<span class="sc">$</span>p.value<span class="sc">&lt;</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(xx<span class="sc">$</span>p.value<span class="sc">&lt;</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(xxx<span class="sc">$</span>p.value<span class="sc">&lt;</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 29</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> edsgk[<span class="fu">rownames</span>(edsgk) <span class="sc">%in%</span> <span class="fu">rownames</span>(x)[x<span class="sc">$</span>p.value<span class="sc">&lt;</span><span class="fl">0.05</span>],]</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vioplot)</span></code></pre></div>
<pre><code>## Loading required package: sm</code></pre>
<pre><code>## Package &#39;sm&#39;, version 2.2-5.6: type help(sm) for summary information</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&#39;gka.png&#39;</span>,<span class="at">width =</span> <span class="dv">2000</span>,<span class="at">height =</span> <span class="dv">1000</span>,<span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">0</span>)<span class="sc">+</span><span class="fl">0.1</span>,<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vioplot</span>(df[<span class="dv">1</span>,]<span class="sc">~</span>phenotype<span class="sc">$</span>hs_asthma,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>,<span class="at">main=</span><span class="st">&#39;C14.1&#39;</span>,<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="at">at=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;health&#39;</span>,<span class="st">&#39;asthma&#39;</span>))</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vioplot</span>(df[<span class="dv">2</span>,]<span class="sc">~</span>phenotype<span class="sc">$</span>hs_asthma,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>,<span class="at">main=</span><span class="st">&#39;PC.ae.C38.5&#39;</span>,<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="at">at=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;health&#39;</span>,<span class="st">&#39;asthma&#39;</span>))</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vioplot</span>(df[<span class="dv">3</span>,]<span class="sc">~</span>phenotype<span class="sc">$</span>hs_asthma,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>,<span class="at">main=</span><span class="st">&#39;Val&#39;</span>,<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="at">at=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;health&#39;</span>,<span class="st">&#39;asthma&#39;</span>))</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
</div>
<div id="gene" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Gene</h1>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/exposome.RData&quot;</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/genexpr.Rdata&quot;</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Biobase)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>pds <span class="ot">&lt;-</span> <span class="fu">pData</span>(genexpr)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>fds <span class="ot">&lt;-</span> <span class="fu">fData</span>(genexpr)</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>eds <span class="ot">&lt;-</span> <span class="fu">exprs</span>(genexpr)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>exposome <span class="ot">&lt;-</span> exposome[<span class="fu">match</span>(pds<span class="sc">$</span>ID,exposome<span class="sc">$</span>ID),]</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="co"># only use numeric vairable</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>row <span class="ot">&lt;-</span> <span class="fu">sapply</span>(exposome, is.numeric)</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>exp <span class="ot">&lt;-</span> <span class="fu">t</span>(exposome[,row])</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>phenotype <span class="ot">&lt;-</span> phenotype[<span class="fu">match</span>(pds<span class="sc">$</span>ID,phenotype<span class="sc">$</span>ID),]</span></code></pre></div>
</div>
<div id="gatekeeper-discovery-1" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Gatekeeper Discovery</h1>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github(&#39;yufree/enet&#39;)</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(enet)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check correlation among exposure</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>enet <span class="ot">&lt;-</span> <span class="fu">geteenet</span>(exp[<span class="sc">-</span><span class="dv">1</span>,])</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_edgelist</span>(<span class="fu">as.matrix</span>(enet<span class="sc">$</span>net[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]),<span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n,<span class="at">vertex.size=</span><span class="fl">0.5</span>,<span class="at">vertex.label=</span><span class="cn">NA</span>)</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="co"># check correlation among metabolites</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>mnets <span class="ot">&lt;-</span> <span class="fu">getmmnet</span>(eds)</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_edgelist</span>(<span class="fu">as.matrix</span>(mnets<span class="sc">$</span>net[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]),<span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n,<span class="at">vertex.size=</span><span class="fl">0.5</span>,<span class="at">vertex.label=</span><span class="cn">NA</span>)</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="co"># check correlation between metabolites and exposures</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="fu">getemnet</span>(<span class="fu">exp</span>(eds),exp[<span class="sc">-</span><span class="dv">1</span>,])</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a><span class="co"># screen gatekeeper</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>gkidx <span class="ot">&lt;-</span> <span class="fu">sapply</span>(re<span class="sc">$</span>data, <span class="cf">function</span>(x) <span class="fu">dim</span>(x)[<span class="dv">2</span>]<span class="sc">==</span><span class="dv">4</span>)</span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>edsgk <span class="ot">&lt;-</span> eds[gkidx,]</span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>exposome <span class="ot">&lt;-</span> exposome[<span class="fu">match</span>(pdu<span class="sc">$</span>ID,exposome<span class="sc">$</span>ID),]</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co"># only use numeric vairable</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>row <span class="ot">&lt;-</span> <span class="fu">sapply</span>(exposome, is.numeric)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>exp <span class="ot">&lt;-</span> <span class="fu">t</span>(exposome[,row])</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>phenotype <span class="ot">&lt;-</span> phenotype[<span class="fu">match</span>(pdu<span class="sc">$</span>ID,phenotype<span class="sc">$</span>ID),]</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co"># check correlation among metabolites</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>mnets <span class="ot">&lt;-</span> <span class="fu">getmmnet</span>(edu)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_edgelist</span>(<span class="fu">as.matrix</span>(mnets<span class="sc">$</span>net[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]),<span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n,<span class="at">vertex.size=</span><span class="fl">0.5</span>,<span class="at">vertex.label=</span><span class="cn">NA</span>)</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="co"># check correlation between metabolites and exposures</span></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="fu">getemnet</span>(<span class="fu">exp</span>(edu),exp[<span class="sc">-</span><span class="dv">1</span>,])</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a><span class="co"># screen gatekeeper</span></span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>gkidx <span class="ot">&lt;-</span> <span class="fu">sapply</span>(re<span class="sc">$</span>data, <span class="cf">function</span>(x) <span class="fu">dim</span>(x)[<span class="dv">2</span>]<span class="sc">==</span><span class="dv">4</span>)</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>edsgk <span class="ot">&lt;-</span> eds[gkidx,]</span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(edsgk,<span class="at">file =</span> <span class="st">&#39;genegk.csv&#39;</span>)</span></code></pre></div>
<p>278 metabolites correlation network clusters found
28026 out of 28738 metabolites have no correlation with other metabolites
169 exposures could be used for network analysis
15 exposures correlation network clusters found
91 out of 169 exposures have no correlation with other exposures
2680 peaks with multiple exposures associated
171 peaks with 6 exposures associated
1610 peaks with 1 exposures associated
700 peaks with 2 exposures associated
203 peaks with 5 exposures associated
43 peaks with 13 exposures associated
292 peaks with 4 exposures associated
65 peaks with 10 exposures associated
101 peaks with 8 exposures associated
30 peaks with 17 exposures associated
122 peaks with 7 exposures associated
481 peaks with 3 exposures associated
7 peaks with 24 exposures associated
84 peaks with 9 exposures associated
53 peaks with 12 exposures associated
52 peaks with 14 exposures associated
33 peaks with 16 exposures associated
59 peaks with 11 exposures associated
34 peaks with 15 exposures associated
4 peaks with 27 exposures associated
11 peaks with 21 exposures associated
12 peaks with 20 exposures associated
21 peaks with 18 exposures associated
1 peaks with 39 exposures associated
6 peaks with 26 exposures associated
9 peaks with 22 exposures associated
16 peaks with 44 exposures associated
7 peaks with 30 exposures associated
1 peaks with 35 exposures associated
17 peaks with 19 exposures associated
5 peaks with 28 exposures associated
13 peaks with 23 exposures associated
2 peaks with 41 exposures associated
1 peaks with 42 exposures associated
5 peaks with 34 exposures associated
3 peaks with 29 exposures associated
8 peaks with 31 exposures associated
1 peaks with 33 exposures associated
1 peaks with 36 exposures associated
3 peaks with 25 exposures associated
1 peaks with 37 exposures associated
1 peaks with 38 exposures associated
1 peaks with 46 exposures associated
257 peaks connected with other peaks and exposures
4033 peaks connected with exposures only</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> genefilter<span class="sc">::</span><span class="fu">rowttests</span>(edsgk,<span class="fu">factor</span>(phenotype<span class="sc">$</span>hs_asthma))</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> genefilter<span class="sc">::</span><span class="fu">rowttests</span>(eds,<span class="fu">factor</span>(phenotype<span class="sc">$</span>hs_asthma))</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>xxx <span class="ot">&lt;-</span> genefilter<span class="sc">::</span><span class="fu">rowttests</span>(exp[<span class="sc">-</span><span class="dv">1</span>,],<span class="fu">factor</span>(phenotype<span class="sc">$</span>hs_asthma))</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">p.adjust</span>(x<span class="sc">$</span>p.value<span class="sc">&lt;</span><span class="fl">0.05</span>,<span class="st">&#39;BH&#39;</span>))</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 89</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">p.adjust</span>(xx<span class="sc">$</span>p.value<span class="sc">&lt;</span><span class="fl">0.05</span>,<span class="st">&#39;BH&#39;</span>))</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1481</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">p.adjust</span>(xxx<span class="sc">$</span>p.value<span class="sc">&lt;</span><span class="fl">0.05</span>,<span class="st">&#39;BH&#39;</span>))</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 36</span></span></code></pre></div>
</div>
</div>



<script>
// when the page is about to reload via servr, remember the scroll position
document.addEventListener('servr:reload', function(e) {
  sessionStorage.setItem('pagedown-scroll', window.scrollY);
});
</script>
</body>
</html>
